---
eip: 5566
title: Stealth Address Wallets
description: Stealth addresses for smart contract wallets
author: Anton Wahrstätter (@Nerolation)
discussions-to: https://ethresear.ch/t/erc721-extension-for-zk-snarks/13237
status: Draft
type: Standards Track
category: ERC
created: 2022-08-13
requires: 165
---


## Abstract
This specification defines a standardized way of creating stealth addresses for smart contract wallets. This ERC enables senders of transactions/transfers to generate private stealth addresses for their recipients that only the recipient can eventually unlock.

## Motivation
The standardization of stealth address generation may unlock significant privacy potential within Smart Contract Wallets, allowing the recipient of a transfer to remain private when receiving an asset. A Stealth address is generated by the sender from a shared secret between sender and recipient and can only be unlocked by the recipient because only the recipient can compute the matching private key.
Observers have no possibility of linking the recipient's stealth address to the recipient's identity, leaving only the sender with that information.

## Specification
The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in RFC 2119.

Every `ERC-N` compliant smart contract wallet MUST implement the `ERC165` (`0x01ffc9a7`) interface.

```solidity
// SPDX-License-Identifier: CC0-1.0
pragma solidity ^0.8.6;
...
interface ERC-N {
    
    /// @notice Public Key coordinates of the wallet owner
    /// @dev Is used by other wallets to generate stealth addresses
    ///  on behalf of the wallet owner.
    bytes publicKey;


    /// @notice Generates a stealth address that can be accessed only by the recipient.
    /// @dev Function is executed locally by the sender on the recipient's wallet to
    ///  generate a stealthAddress and publishableData S. The Caller/Sender must select a secret
    ///  value s and compute the stealth address of the wallet owner and the matching public key S
    ///  to the selected secret s.
    /// @param secret A secret value selected by the sender
    function generateStealthAddress(uint256 secret) returns (bytes publishableData, address stealthAddress)

}

interface PubStealthInfoContract {

    /// @noticeImmutable contract that broadcasts an 
    ///  event with the address of the stealthRecipient and 
    ///  publishableData S for every privateTransfer. 
    /// @dev Emits event with private transfer information S and the recipient's address.
    ///  S is generated by the sender and represents the public key to the secret s.
    ///  The sender broadcasts S for every private transfer. Users can use S to check if they were
    ///  the recipients of a respective transfer by comparing it to stealthRecipient.
    /// @param stealthRecipient The address to send the funds to
    /// @param publishableData The public key to the sender's secret
    event PrivateTransfer(address indexed stealthRecipient, bytes publishableData)
}
```

#### Stealth Address Generation


Sender Keypair    --> (s,S) | S = s * G 

Recipient Keypair --> (p,P) | P = p * G

NOTE: `s` represents a sender-generated secret


#### For transfering:

sharedSecret    = s*P

stealthAddress  = pubtoaddr(P + (G * keccak(sharedSecret)))

publishableData = G * s = S



#### For receiving:

for all PrivateTransfer Events do:

if pubtoaddr(P + (G * keccak(S * p))) == stealthRecipient:

store_key(p + keccak(S * p))



## Rationale
`EIP-N` emerged from the need of having privacy-preserving ways to transfer ownership without revealing the recipient's identity. Tokens can reveal sensitive private information about the owner. While users might want to prove the ownership of an NFT concert ticket, they might not want to reveal personal account-related information at the same time. The standardization of stealth address generation represents a significant step for privacy. Privacy-preserving solutions require standards to gain adoption, therefore it is critical to focus on generalizable ways of implementing related solutions.

This extension standardizes the method to create and look up Stealth Addresses. Users can send assets without having to interact with the recipient beforehand. Stealth addresses allow only the recipients of token transfers to see that they were the recipients.


## Backwards Compatibility
EIP--- is fully backward compatible with basic `ERC-721` contracts. `EIP---` implements the `EIP-165` standard.

## Reference Implementation
You can find an implementation of this standard in [./eip.sol](https://github.com/Nerolation/EIP-Stealth-Address-ERC/blob/main/gnosisSafeModule.sol).

## Security Considerations
TBD

## Copyright
Copyright and related rights waived via [CC0](../LICENSE.md).
